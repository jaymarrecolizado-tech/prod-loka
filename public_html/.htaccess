# LOKA Fleet Management - Security Configuration

# Prevent directory listing
Options -Indexes

# Deny access to sensitive files
<FilesMatch "^\.">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Deny access to config files
<FilesMatch "\.(php|log|sql|md)$">
    <If "%{REQUEST_URI} =~ m#/(config|classes|migrations|logs)/#">
        <IfModule mod_authz_core.c>
            Require all denied
        </IfModule>
        <IfModule !mod_authz_core.c>
            Order deny,allow
            Deny from all
        </IfModule>
    </If>
</FilesMatch>

# Block access to specific directories
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Block direct access to config, classes, migrations
    RewriteRule ^config/ - [F,L]
    RewriteRule ^classes/ - [F,L]
    RewriteRule ^migrations/ - [F,L]
    RewriteRule ^logs/ - [F,L]
    RewriteRule ^includes/ - [F,L]
</IfModule>

# Security Headers (fallback if PHP headers fail)
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Disable server signature
ServerSignature Off

# PHP Security Settings (if available)
<IfModule mod_php.c>
    php_flag display_errors off
    php_flag expose_php off
</IfModule>
