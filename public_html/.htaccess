# LOKA Fleet Management - .htaccess Configuration

# =============================================================================
# Directory Security
# =============================================================================

# Prevent directory listing
Options -Indexes

# =============================================================================
# URL Routing & Access Control
# =============================================================================

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Block direct access to sensitive directories
    RewriteRule ^config/ - [F,L]
    RewriteRule ^classes/ - [F,L]
    RewriteRule ^includes/ - [F,L]
    RewriteRule ^migrations/ - [F,L]
    RewriteRule ^logs/ - [F,L]
    RewriteRule ^cache/ - [F,L]
    RewriteRule ^data/ - [F,L]

    # Block access to sensitive files
    RewriteRule ^\.env - [F,L]
    RewriteRule \.(log|sql)$ - [F,L]
</IfModule>

# =============================================================================
# Security Headers
# =============================================================================

<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Disable server signature
ServerSignature Off

# =============================================================================
# PHP Settings (if available)
# =============================================================================

<IfModule mod_php.c>
    php_flag display_errors off
    php_flag expose_php off
</IfModule>

<IfModule mod_php8.c>
    php_value max_execution_time 30
    php_value max_input_time 30
    php_value memory_limit 128M
    php_value upload_max_filesize 2M
    php_value post_max_size 2M
    php_value max_file_uploads 5
    php_value max_input_vars 1000
</IfModule>
